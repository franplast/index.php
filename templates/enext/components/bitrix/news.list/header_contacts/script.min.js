!function(s){"use strict";s.JCNewsListHeaderContacts||(s.JCNewsListHeaderContacts=function(s){this.visual={ID:""},this.item={address:"",timezone:"",workingHours:{},phone:{},email:{},skype:{}},this.sPanel=null,this.obItem=null,this.errorCode=0,"object"==typeof s&&(this.visual=s.VISUAL,this.item.address=s.ITEM.ADDRESS,this.item.timezone=s.ITEM.TIMEZONE,this.item.workingHours=s.ITEM.WORKING_HOURS,this.item.phone=s.ITEM.PHONE.VALUE,this.item.phoneDescription=s.ITEM.PHONE.DESCRIPTION,this.item.email=s.ITEM.EMAIL.VALUE,this.item.emailDescription=s.ITEM.EMAIL.DESCRIPTION,this.item.skype=s.ITEM.SKYPE.VALUE,this.item.skypeDescription=s.ITEM.SKYPE.DESCRIPTION,BX.ready(BX.delegate(this.init,this)))},s.JCNewsListHeaderContacts.prototype={init:function(){this.sPanel=document.body.querySelector(".slide-panel"),this.obItem=BX(this.visual.ID),this.obItem||(this.errorCode=-1),0===this.errorCode&&(BX.bind(this.obItem,"click",BX.proxy(this.showContacts,this)),BX.addCustomEvent(this,"getWorkingHoursToday",BX.proxy(this.getWorkingHoursToday,this)),BX.addCustomEvent(this,"workingHoursTodayReceived",BX.proxy(this.adjustContacts,this)),BX.addCustomEvent(this,"contactsAdjusted",BX.proxy(this.showContactsRequest,this)),this.sPanel&&(BX.bind(document,"click",BX.delegate(function(s){if(BX.hasClass(this.sPanel,"active")&&BX.findParent(s.target,{attrs:{id:this.visual.ID+"_contacts"}})&&BX.hasClass(s.target,"icon-arrow-down")){var t=BX.findParent(s.target,{attrs:{"data-entity":"working-hours-today"}});t&&BX.style(t,"display","none");var i=BX(this.visual.ID+"_contacts").querySelector('[data-entity="working-hours"]');i&&BX.style(i,"display",""),s.stopPropagation()}},this)),BX.bind(document,"click",BX.delegate(function(s){if(BX.hasClass(this.sPanel,"active")&&BX.findParent(s.target,{attrs:{id:this.visual.ID+"_contacts"}})&&BX.hasClass(s.target,"icon-arrow-up")){var t=BX.findParent(s.target,{attrs:{"data-entity":"working-hours"}});t&&BX.style(t,"display","none");var i=BX(this.visual.ID+"_contacts").querySelector('[data-entity="working-hours-today"]');i&&BX.style(i,"display",""),s.stopPropagation()}},this))))},getWorkingHoursToday:function(s){BX.ajax({url:BX.message("HEADER_CONTACTS_TEMPLATE_PATH")+"/ajax.php",method:"POST",dataType:"json",timeout:60,data:{action:"workingHoursToday",timezone:this.item.timezone,workingHours:this.item.workingHours},onsuccess:BX.delegate(function(t){t.today&&(this.item.workingHoursToday=t.today),BX.onCustomEvent(this,"workingHoursTodayReceived",[s])},this)})},adjustContacts:function(s){var t="";if(this.item.address||this.item.workingHours||this.item.workingHoursToday||this.item.phone||this.item.email||this.item.skype){if(t+='<div class="slide-panel__contacts" id="'+this.visual.ID+'_contacts">',this.item.address&&(t+='<div class="slide-panel__contacts-item">',t+='<div class="slide-panel__contacts-item__block">',t+='<div class="slide-panel__contacts-item__icon"><i class="icon-map-marker"></i></div>',t+='<div class="slide-panel__contacts-item__text">'+this.item.address+"</div>",t+="</div>",t+="</div>"),this.item.workingHoursToday)for(var i in this.item.workingHoursToday)this.item.workingHoursToday.hasOwnProperty(i)&&(t+='<div class="slide-panel__contacts-item" data-entity="working-hours-today">',t+='<div class="slide-panel__contacts-item__hours-today">',t+='<div class="slide-panel__contacts-item__today-container">',t+='<div class="slide-panel__contacts-item__today">',t+='<span class="slide-panel__contacts-item__today-icon"><i class="icon-clock"></i></span>',t+='<span class="slide-panel__contacts-item__today-title">'+BX.message("HEADER_CONTACTS_ITEM_TODAY")+"</span>",this.item.workingHoursToday[i].STATUS&&(t+='<span class="slide-panel__contacts-item__today-status slide-panel__contacts-item__today-status-'+("OPEN"==this.item.workingHoursToday[i].STATUS?"open":"closed")+'"></span>'),t+="</div>",t+="</div>",t+='<div class="slide-panel__contacts-item__hours-break">',t+='<div class="slide-panel__contacts-item__hours slide-panel__contacts-item__hours-first">',t+='<span class="slide-panel__contacts-item__hours-title">',this.item.workingHoursToday[i].WORK_START&&this.item.workingHoursToday[i].WORK_END?this.item.workingHoursToday[i].WORK_START!=this.item.workingHoursToday[i].WORK_END?t+=this.item.workingHoursToday[i].WORK_START+" - "+this.item.workingHoursToday[i].WORK_END:t+=BX.message("HEADER_CONTACTS_ITEM_24_HOURS"):t+=BX.message("HEADER_CONTACTS_ITEM_OFF"),t+="</span>",t+='<span class="slide-panel__contacts-item__hours-icon"><i class="icon-arrow-down"></i></span>',t+="</div>",this.item.workingHoursToday[i].WORK_START&&this.item.workingHoursToday[i].WORK_END&&this.item.workingHoursToday[i].WORK_START!=this.item.workingHoursToday[i].WORK_END&&this.item.workingHoursToday[i].BREAK_START&&this.item.workingHoursToday[i].BREAK_END&&this.item.workingHoursToday[i].BREAK_START!=this.item.workingHoursToday[i].BREAK_END&&(t+='<div class="slide-panel__contacts-item__break">',t+=BX.message("HEADER_CONTACTS_ITEM_BREAK")+" "+this.item.workingHoursToday[i].BREAK_START+" - "+this.item.workingHoursToday[i].BREAK_END,t+="</div>"),t+="</div>",t+="</div>",t+="</div>");if(this.item.workingHours){t+='<div class="slide-panel__contacts-item" data-entity="working-hours"'+(this.item.workingHoursToday?'style="display: none;"':"")+">";var e=0;for(var i in this.item.workingHours)this.item.workingHours.hasOwnProperty(i)&&(t+='<div class="slide-panel__contacts-item__hours-today">',t+='<div class="slide-panel__contacts-item__today-container">',t+='<div class="slide-panel__contacts-item__today">',0==e&&(t+='<span class="slide-panel__contacts-item__today-icon"><i class="icon-clock"></i></span>'),t+='<span class="slide-panel__contacts-item__today-title">'+(this.item.workingHoursToday&&this.item.workingHoursToday.hasOwnProperty(i)?BX.message("HEADER_CONTACTS_ITEM_TODAY"):this.item.workingHours[i].NAME)+"</span>",this.item.workingHoursToday&&this.item.workingHoursToday.hasOwnProperty(i)&&this.item.workingHoursToday[i].STATUS&&(t+='<span class="slide-panel__contacts-item__today-status slide-panel__contacts-item__today-status-'+("OPEN"==this.item.workingHoursToday[i].STATUS?"open":"closed")+'"></span>'),t+="</div>",t+="</div>",t+='<div class="slide-panel__contacts-item__hours-break">',t+='<div class="slide-panel__contacts-item__hours'+(0==e?" slide-panel__contacts-item__hours-first":"")+'">',t+='<span class="slide-panel__contacts-item__hours-title">',this.item.workingHours[i].WORK_START&&this.item.workingHours[i].WORK_END?this.item.workingHours[i].WORK_START!=this.item.workingHours[i].WORK_END?t+=this.item.workingHours[i].WORK_START+" - "+this.item.workingHours[i].WORK_END:t+=BX.message("HEADER_CONTACTS_ITEM_24_HOURS"):t+=BX.message("HEADER_CONTACTS_ITEM_OFF"),t+="</span>",this.item.workingHoursToday&&0==e&&(t+='<span class="slide-panel__contacts-item__hours-icon"><i class="icon-arrow-up"></i></span>'),t+="</div>",this.item.workingHours[i].WORK_START&&this.item.workingHours[i].WORK_END&&this.item.workingHours[i].WORK_START!=this.item.workingHours[i].WORK_END&&this.item.workingHours[i].BREAK_START&&this.item.workingHours[i].BREAK_END&&this.item.workingHours[i].BREAK_START!=this.item.workingHours[i].BREAK_END&&(t+='<div class="slide-panel__contacts-item__break">',t+=BX.message("HEADER_CONTACTS_ITEM_BREAK")+" "+this.item.workingHours[i].BREAK_START+" - "+this.item.workingHours[i].BREAK_END,t+="</div>"),t+="</div>",t+="</div>",e++);t+="</div>"}if(this.item.phone)for(var i in this.item.phone)this.item.phone.hasOwnProperty(i)&&(t+='<div class="slide-panel__contacts-item">',t+='<div class="slide-panel__contacts-item__block">',t+='<div class="slide-panel__contacts-item__icon"><i class="icon-phone"></i></div>',t+='<div class="slide-panel__contacts-item__text">',t+='<a class="slide-panel__contacts-item__phone slide-panel__contacts-item__link" href="tel:'+this.item.phone[i].replace(/[^\d\+]/g,"")+'">'+this.item.phone[i]+"</a>",this.item.phoneDescription.hasOwnProperty(i)&&this.item.phoneDescription[i].length>0&&(t+='<span class="slide-panel__contacts-item__descr">'+this.item.phoneDescription[i]+"</span>"),t+="</div>",t+="</div>",t+="</div>");if(this.item.email)for(var i in this.item.email)this.item.email.hasOwnProperty(i)&&(t+='<div class="slide-panel__contacts-item">',t+='<div class="slide-panel__contacts-item__block">',t+='<div class="slide-panel__contacts-item__icon"><i class="icon-mail"></i></div>',t+='<div class="slide-panel__contacts-item__text">',t+='<a class="slide-panel__contacts-item__link" href="mailto:'+this.item.email[i]+'">'+this.item.email[i]+"</a>",this.item.emailDescription.hasOwnProperty(i)&&this.item.emailDescription[i].length>0&&(t+='<span class="slide-panel__contacts-item__descr">'+this.item.emailDescription[i]+"</span>"),t+="</div>",t+="</div>",t+="</div>");if(this.item.skype)for(var i in this.item.skype)this.item.skype.hasOwnProperty(i)&&(t+='<div class="slide-panel__contacts-item">',t+='<div class="slide-panel__contacts-item__block">',t+='<div class="slide-panel__contacts-item__icon"><i class="fa fa-skype"></i></div>',t+='<div class="slide-panel__contacts-item__text">',t+='<a class="slide-panel__contacts-item__link" href="skype:'+this.item.skype[i]+'?chat">'+this.item.skype[i]+"</a>",this.item.skypeDescription.hasOwnProperty(i)&&this.item.skypeDescription[i].length>0&&(t+='<span class="slide-panel__contacts-item__descr">'+this.item.skypeDescription[i]+"</span>"),t+="</div>",t+="</div>",t+="</div>");t+="</div>"}BX.onCustomEvent(this,"contactsAdjusted",[t,s])},showContactsRequest:function(s,t){BX.ajax({url:BX.message("SITE_DIR")+"ajax/slide_panel.php",method:"POST",dataType:"json",timeout:60,data:{action:"callback"},onsuccess:BX.delegate(function(i){i.content&&i.JS?BX.ajax.processScripts(BX.processHTML(i.JS).SCRIPT,!1,BX.delegate(function(){var e=BX.processHTML(i.content);t.innerHTML=s+e.HTML,BX.ajax.processScripts(e.SCRIPT)},this)):t.innerHTML=s,$(t).scrollbar()},this)})},showContacts:function(t){if(this.sPanel){this.sPanel.appendChild(BX.create("DIV",{props:{className:"slide-panel__title-wrap"},children:[BX.create("I",{props:{className:"icon-phone-call"}}),BX.create("SPAN",{props:{className:"slide-panel__title"},html:BX.message("HEADER_CONTACTS_TITLE")}),BX.create("SPAN",{props:{className:"slide-panel__close"},children:[BX.create("I",{props:{className:"icon-close"}})]})]})),this.sPanel.appendChild(BX.create("DIV",{props:{className:"slide-panel__content scrollbar-inner"},children:[BX.create("DIV",{props:{className:"slide-panel__loader"},html:"<div><span></span></div>"})]}));var i=this.sPanel.querySelector(".slide-panel__content");i&&BX.onCustomEvent(this,"getWorkingHoursToday",[i]);var e=s.innerWidth-document.body.clientWidth;if(e>0){BX.style(document.body,"padding-right",e+"px");var a=document.querySelector(".page-bg");a&&BX.style(a,"margin-right",e+"px");var o=document.querySelector(".top-panel");if(o){BX.hasClass(o,"fixed")&&BX.style(o,"padding-right",e+"px");var n=o.querySelector(".top-panel__thead");n&&BX.hasClass(n,"fixed")&&BX.style(n,"padding-right",e+"px");var r=o.querySelector(".top-panel__tfoot");r&&BX.hasClass(r,"fixed")&&BX.style(r,"padding-right",e+"px")}var c=document.querySelector(".catalog-section-panel");c&&BX.hasClass(c,"fixed")&&BX.style(c,"padding-right",e+"px");var l=document.querySelector('[data-entity="tabs"]');l&&BX.hasClass(l,"fixed")&&BX.style(l,"padding-right",e+"px");var d=document.querySelector(".objects-map");d&&BX.style(d,"padding-right",e+"px")}var _=BX.GetWindowScrollPos().scrollTop;_&&_>0&&BX.style(document.body,"top","-"+_+"px"),BX.addClass(document.body,"slide-panel-active"),BX.addClass(this.sPanel,"active"),document.body.appendChild(BX.create("DIV",{props:{className:"modal-backdrop slide-panel__backdrop fadeInBig"}})),t.stopPropagation()}}})}(window);